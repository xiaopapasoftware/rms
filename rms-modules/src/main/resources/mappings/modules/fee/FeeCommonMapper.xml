<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.thinkgem.jeesite.modules.fee.common.dao.FeeCommonDao">

    <select id="getRangeIdByRoomId" resultType="java.lang.String">
        SELECT concat_ws(',',tr.id,th.id,tb.id,tpp.id,sa.id,sa.parent_id)
        from t_room tr
        left JOIN t_house th on tr.house_id = th.id and th.DEL_FLAG=0
        left JOIN t_building tb on th.BUILDING_ID=tb.ID and tb.DEL_FLAG=0
        left join t_property_project tpp on tb.T_PROPERTY_PROJECT_MAIN_ID=tpp.ID and tpp.DEL_FLAG=0
        left join sys_area sa on tpp.AREA_ID=sa.id and sa.del_flag=0
        where tr.del_flag=0 and tr.id=#{roomId}
    </select>

    <select id="getRangeIdByHouseId" resultType="java.lang.String">
        SELECT concat_ws(',',th.id,tb.id,tpp.id,sa.id,sa.parent_id) from t_house th
        left JOIN t_building tb on th.BUILDING_ID=tb.ID and tb.DEL_FLAG=0
        left join t_property_project tpp on tb.T_PROPERTY_PROJECT_MAIN_ID=tpp.ID and tpp.DEL_FLAG=0
        left join sys_area sa on tpp.AREA_ID=sa.id and sa.del_flag=0
        where th.del_flag=0 and th.id=#{houseId}
    </select>

</mapper>
